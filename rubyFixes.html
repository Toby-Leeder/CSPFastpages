<article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Ruby Fixes for M1 macs</h1><p class="page-description">Easy steps to fix a lot of weird ruby and gems errors on M1 macs</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2023-01-06T00:00:00-06:00" itemprop="datePublished">
        Jan 6, 2023
      </time>
       • <span class="read-time" title="Estimated read time">
    
    
      4 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/CSPFastpages/categories/#fixes">fixes</a>
        &nbsp;
      
        <a class="category-tags-link" href="/CSPFastpages/categories/#week_16">week_16</a>
        
      
      </p>
    

    </header>

  <div class="post-content e-content" itemprop="articleBody">
    <h1 id="introduction">Introduction</h1>
<p>Essentially the issue to my understanding is mac has a default ruby version which isn’t compatiable for our uses. This isn’t bad, but the problem arises when you want to switch to a different version of ruby. You need to change the path which your system uses for ruby. The way I did this was using Chruby. Chruby is a ruby manager which allows you to change which version of ruby you want. It’s kind of overkill for our purposes, but it was the only thing I could get to work.</p>

<p>There are multiple prominent ruby managers and all of them will probably work. This is how to set up Chruby, but if you would like to look on your own for rvm or rbenv or something else entirely then you definitely can. Chruby is the simplest to use and understand.</p>

<h1 id="what-do-you-do">What do you do</h1>

<h2 id="step-1-install-brew-and-upgrade-brew">Step 1: Install brew and upgrade brew</h2>
<p>First you need to install brew. Homebrew (brew) is a package manager which basically means it helps you install anything and everything that you need. If you don’t have it installed go to this <a href="https://brew.sh/">link</a> and run the command under install.</p>

<p>If you have brew then you need to make sure your brew is up to date. Run the following:</p>
<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>brew outdated <span class="c">#This command checks if your packages are outdated. If any of your packages are outdated, run the next two commands.</span>
<span class="nv">$ </span>brew update 
<span class="nv">$ </span>brew upgrade <span class="c">#These upgrade all of your brew dependencies</span>
</code></pre></div></div>
<p>Restart your terminal (close and reopen)</p>
<h2 id="step-2-install-ruby-manager-and-installer">Step 2: Install ruby manager and installer</h2>
<p>Now you can actually install the ruby manager and installer. Run the follwing:</p>
<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>brew <span class="nb">install </span>chruby ruby-install
</code></pre></div></div>

<h2 id="step-3-install-ruby">Step 3: Install ruby</h2>
<p>Install whatever version of ruby you want. For this project you should use 2.7.7. Run the following:</p>
<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>ruby-install 2.7.7
</code></pre></div></div>

<p>If it fails with it could be because:</p>
<ul>
  <li>Something is wrong with your development setup</li>
  <li>You tried to install Ruby even though Homebrew reported warnings/errors</li>
</ul>

<p>Read the error message and try to fix it. If you can’t send a message on slack and mention Toby and I can look at it.</p>

<h2 id="step-4-cd-into-your-directory">Step 4: cd into your directory</h2>
<p>You should know how to do this. cd into whatever directory has the local server you want to run. This will probably be the repository that you copied from Mr. Mortensen.</p>

<h2 id="step-5-configure-your-shell">Step 5: Configure your shell</h2>
<p>My understanding of this is right now your computer wants to use the built in ruby version so we need to change it so that it uses the correct path. to do that run these three commands (don’t worry when it doesn’t say anything after you run the command, nothing is supposed to happen in terminal):</p>
<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">echo</span> <span class="s2">"source </span><span class="si">$(</span>brew <span class="nt">--prefix</span><span class="si">)</span><span class="s2">/opt/chruby/share/chruby/chruby.sh"</span> <span class="o">&gt;&gt;</span> ~/.zshrc
<span class="nv">$ </span><span class="nb">echo</span> <span class="s2">"source </span><span class="si">$(</span>brew <span class="nt">--prefix</span><span class="si">)</span><span class="s2">/opt/chruby/share/chruby/auto.sh"</span> <span class="o">&gt;&gt;</span> ~/.zshrc
<span class="nv">$ </span><span class="nb">echo</span> <span class="s2">"chruby ruby-2.7.7"</span> <span class="o">&gt;&gt;</span> ~/.zshrc
</code></pre></div></div>

<p>If you get an error saying that the file path can’t be found then restart from upgrading your homebrew. If you get any other error you could also try that or again put it on slack.</p>

<h2 id="step-6-check-if-it-worked">Step 6: Check if it worked</h2>
<p>You should be using the correct ruby version now. Inside of the directory that you used cd to enter earlier run:</p>
<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>ruby <span class="nt">-v</span>
</code></pre></div></div>
<p>If it says 2.7.7 then it worked and you can move on.</p>

<h3 id="if-it-doesnt-say-277-run">If it doesn’t say 2.7.7 run:</h3>
<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>chruby 2.7.7
</code></pre></div></div>

<h3 id="if-that-says-chruby-not-found-or-something-along-those-lines-then-run">If that says chruby not found or something along those lines then run:</h3>
<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">echo</span> <span class="s2">"source ~/.bashrc"</span> <span class="o">&gt;&gt;</span> ~/.bash_profile
</code></pre></div></div>

<p>Then restart the terminal and run:</p>
<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>chruby 2.7.7 
</code></pre></div></div>

<p>If the error persists run:</p>
<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">.</span> /usr/local/opt/chruby/share/chruby/chruby.sh
<span class="nv">$ </span><span class="nb">.</span> ~/.bashrc
</code></pre></div></div>

<p>Then restart the terminal and run:</p>
<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>chruby 2.7.7 
</code></pre></div></div>

<p>If you get a different error (NOT the chruby not found error) or the error still doesn’t go away try restarting from the beginning or send it on slack.</p>

<h2 id="step-7-check-your-gemfile">Step 7: Check your Gemfile</h2>
<p>Your gemfile is a file in the root of your project that you copied from Mr. Mortensen. Open it in vscode and look for it and check if it looks like this:</p>
<pre><code class="language-gem">source "https://rubygems.org"

gem "github-pages", group: :jekyll_plugins
</code></pre>
<p>Delete anything extra that you have.</p>
<h2 id="step-8-install-jekyll-if-you-havent-already">Step 8: Install Jekyll if you haven’t already</h2>
<p>I didn’t need to do this but some of you might. It doesn’t hurt to run it anyway. Run:</p>
<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>gem insall jekyll
</code></pre></div></div>
<h2 id="step-9-install-bundler-if-you-havent-already">Step 9: Install bundler if you haven’t already</h2>
<p>These instructions are also given on the bundler website. Run:</p>
<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>bundle <span class="nb">install</span>
<span class="nv">$ </span>git add Gemfile Gemfile.lock
</code></pre></div></div>

<h2 id="step-10-run-your-server">Step 10: Run your server</h2>
<p>Now you should be ready to run your server. Run:</p>
<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>bundle <span class="nb">exec </span>jekyll serve
</code></pre></div></div>
<p>It will take a very long time the first time you run it.</p>

<h2 id="persisting-errors">Persisting errors</h2>
<p>If you try to run your server and you still get any errors, the first thing you should do is check that you’re using the correct ruby version in the correct directory (ruby -v) If you are then try all of these steps again from the beginning. If you still are getting errors send a message on slack and I can try to help you.</p>

<p>In general however it is a good skill to be able to figure out some of the errors you get on your own. Read the error message, do what it says if there is a quick fix. Google error messages try to work through stuff if you think you’ll be able to.</p>

  </div><a class="u-url" href="/CSPFastpages/rubyFixes" hidden></a>
</article>
